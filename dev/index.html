<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Captcha Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .game-captcha {
            border: 2px dashed #ddd;
            padding: 20px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fafafa;
            border-radius: 4px;
        }
        .game-captcha--dark {
            background: #2a2a2a;
            border-color: #555;
            color: white;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Game Captcha í…ŒìŠ¤íŠ¸ í™˜ê²½</h1>
        <p>React ì»´í¬ë„ŒíŠ¸ë¥¼ ì›¹ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        
        <div class="controls">
            <label>í…Œë§ˆ: 
                <select id="themeSelect">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                </select>
            </label>
            <label>ì–¸ì–´: 
                <select id="localeSelect">
                    <option value="en">English</option>
                    <option value="ko">í•œêµ­ì–´</option>
                </select>
            </label>
            <button onclick="resetCaptcha()">ë¦¬ì…‹</button>
        </div>
        
        <div id="captcha-container"></div>
        
        <div id="result" style="display: none;"></div>
    </div>

    <div class="container">
        <h2>ê°œë°œì ë„êµ¬</h2>
        <p>ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ë¥¼ ì—´ì–´ ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <button onclick="window.toggleDevMode()">ê°œë°œ ëª¨ë“œ í† ê¸€</button>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // GameCaptcha ì»´í¬ë„ŒíŠ¸ (ì‹¤ì œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì—¬ê¸°ì— ë³µì‚¬)
        function GameCaptcha({ onSuccess, siteKey, theme = 'light', locale = 'en' }) {
            const containerRef = useRef(null);

            useEffect(() => {
                const root = containerRef.current;
                if (!root) return;

                console.log('GameCaptcha ì´ˆê¸°í™”:', { theme, locale, siteKey });

                // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ìš© ê²Œì„ UI ìƒì„±
                root.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <h3>ğŸ® ê²Œì„ CAPTCHA</h3>
                        <p>í…ŒìŠ¤íŠ¸ìš© ê²Œì„ì…ë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                        <button 
                            id="game-button" 
                            style="
                                padding: 15px 30px; 
                                font-size: 16px; 
                                background: ${theme === 'dark' ? '#4caf50' : '#007bff'}; 
                                color: white; 
                                border: none; 
                                border-radius: 4px; 
                                cursor: pointer;
                            "
                        >
                            ğŸ¯ ê²Œì„ ì™„ë£Œí•˜ê¸°
                        </button>
                        <div style="margin-top: 10px; font-size: 12px; color: #666;">
                            í…Œë§ˆ: ${theme} | ì–¸ì–´: ${locale}
                        </div>
                    </div>
                `;

                const button = root.querySelector('#game-button');
                const handleClick = () => {
                    const token = 'gc_test_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    console.log('ê²Œì„ ì™„ë£Œ! í† í° ìƒì„±:', token);
                    onSuccess(token);
                };

                button.addEventListener('click', handleClick);

                return () => {
                    button?.removeEventListener('click', handleClick);
                };
            }, [onSuccess, siteKey, theme, locale]);

            return React.createElement('div', {
                className: `game-captcha game-captcha--${theme}`,
                ref: containerRef,
                'aria-label': 'game captcha'
            });
        }

        // í…ŒìŠ¤íŠ¸ ì•±
        function TestApp() {
            const [theme, setTheme] = useState('light');
            const [locale, setLocale] = useState('en');
            const [result, setResult] = useState(null);
            const [key, setKey] = useState(0); // ì»´í¬ë„ŒíŠ¸ ë¦¬ì…‹ìš©

            const handleSuccess = (token) => {
                console.log('CAPTCHA ì„±ê³µ:', token);
                setResult({
                    success: true,
                    token: token,
                    timestamp: new Date().toLocaleString()
                });
                
                // ê²°ê³¼ í‘œì‹œ
                const resultDiv = document.getElementById('result');
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <strong>âœ… CAPTCHA ì„±ê³µ!</strong><br>
                    í† í°: <code>${token}</code><br>
                    ì‹œê°„: ${new Date().toLocaleString()}
                `;
            };

            useEffect(() => {
                // ì™¸ë¶€ ì»¨íŠ¸ë¡¤ê³¼ ì—°ë™
                const themeSelect = document.getElementById('themeSelect');
                const localeSelect = document.getElementById('localeSelect');
                
                const handleThemeChange = (e) => setTheme(e.target.value);
                const handleLocaleChange = (e) => setLocale(e.target.value);
                
                themeSelect.addEventListener('change', handleThemeChange);
                localeSelect.addEventListener('change', handleLocaleChange);
                
                // ì „ì—­ í•¨ìˆ˜ ë“±ë¡
                window.resetCaptcha = () => {
                    setKey(prev => prev + 1);
                    setResult(null);
                    document.getElementById('result').style.display = 'none';
                };
                
                window.toggleDevMode = () => {
                    console.log('í˜„ì¬ ìƒíƒœ:', { theme, locale, result });
                    alert('ê°œë°œì ë„êµ¬ë¥¼ ì—´ì–´ ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”!');
                };

                return () => {
                    themeSelect.removeEventListener('change', handleThemeChange);
                    localeSelect.removeEventListener('change', handleLocaleChange);
                };
            }, [theme, locale, result]);

            return React.createElement(GameCaptcha, {
                key: key,
                onSuccess: handleSuccess,
                theme: theme,
                locale: locale,
                siteKey: 'test-site-key'
            });
        }

        // ë Œë”ë§
        const container = document.getElementById('captcha-container');
        const root = ReactDOM.createRoot(container);
        root.render(React.createElement(TestApp));
    </script>
</body>
</html>